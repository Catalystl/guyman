<!DOCTYPE html>
<html>
	<head>
		<title>guyman build 2 or something</title>
		<!--
		
		GUYMAN pre-alpha v0.0 by catalystl
		This is my sixth attempt at a full game made only in javascript.
		The whole game is included in this one html file.
		
		
		PROGRAM NAVIGATION:
		---
		
		To navigate through the .html file and edit the game, use CTRL+F
		and input the following sections written with [] instead of {}.
		
		
		sections with subsections:
		{O "name of object"}		skip to object code (example: {O guyman})
		{M "name of map"}			skip to map (example: {M l1})
		{P "name of particle"}		skip to particle (example: {P template})
		
		
		NOTE: for the O & P sections skip to {O/P indexEnd} to get to the end of the objects/particles defined
		
		
		important sections:
		{DA} = data (sprites, maps, objects, etc.)
		{DR} = drawing
		{C} = collision
		{K} = keyboard input
		{GD} = getting data (choosing what sprites to uncompress and loading the map)
		{MI} = misc functions (starting cutscene)
		{CS} = cutscenes
		{EV} = events
		{MP} = maps
		
		important functions:
		lm( map x increase, map y increase )
		ls( log text )
		
		
		IDEAS FOR THINGS TO ADD:
		---
		*	instances
		*	sprites
		spike chamber waving up and down
		*	blood splattering
		*	particle system
		story
		10 levels minimum
		*	bees
		*	map editor
		*	map loading
		*	collision with other objects
		*	allow tile checking with certain indexes to be checked
		include ryan in the game
		include the face
		ummmmmmm
		*	do nothing
		release the game ok
		*	stars in background
		game manual?
		music soundfount
		music editor
		music player
		music for title
		music for game 1
		music for game 2
		music for final battle
		music for credits
		music for secret
		*	restart level
		title screen
		*	wizard magician man
		
		*	tlaking
		
		
		
		
		
		bees not respawning in rooms where you have collected them
		keeping guyman above spikes when changing rooms
		*	gui
		triggers 
		finish spooky land
		make birds
		finish bird land
		event system
		
		intro levels
		
		
		
		
		
		
		
		
		*	set guyman speed limit
		*	collision for rectangle in rectangle
		keep guyman skeleton when restarting map
		
		
		*	keeping guyman cutscene prop not stuck in ground
		
		youve died in this room x amount of times (and include statement like: loser)
		
		5 levels
		10 levels
		15 levels
		20 levels
		25 levels
		30 levels
		35 levels
		40 levels
		
		*	collision
		*	guyman
		
		
		OBJECT #S:
		---
		0 = template
		1 = guyman
		2 = blood
		3 = corn
		4 = bee
		5 = wizard magician man
		6 = guyman skeleton
		7 = guyman cutscene
		
		PARTICLE #S:
		---
		0 = template
		1 = flame downwards
		2 = flame sideways
		3 = dust
		4 = yay particle
		5 = star
		
		PALETTES:
		---
		
		0 = normal
		1 = spooky land
		
		
		TO OPTIMISE:
		---
		level transition code in guyman's update function
		
		BUGFIXES:
		---
		fix guyman's body and scarf appearing on the opposite side of the screen
		make compressed maps more compressed
		
		
		
		-->
	</head>
	<style>
		body{
			font-family: courier;
		}
		h1{
			text-shadow: 2px 2px #aaf;
		}
		#heInfo{
			width: 640px; 
			background-color: #000; 
			color: #fff; 
			position: relative; 
			top: 2px;
		}
		canvas{
			border: 0px solid #000;
		}
		
	</style>
	<body>
		<center>
			<h1>guyman</h1>
			
			<table><tr><td id="heInfo">
			bees: <span id="heBees">0</span>
			/
			deaths: <span id="heDeaths">0</span>
			
			</td></tr></table>
			
			<canvas id="can" width="640" height="480" style="border: 0px solid #000;">ur browser doesn't support the canvas element noob</canvas>
			
			<br><br>
			
			<span id="heLog"></span>
		</center>
		
		
		<script>
			// setting up canvas
			var cv = document.getElementById("can");
			var cx = cv.getContext("2d", { alpha: false });
			
			var c = cx.getImageData(0,0,cv.width,cv.height);
			
			// log
			var log = document.getElementById("heLog");
			
			// universal tick
			var univ = true;
			var uniTick = 0;
			var uniReset = 8;
			
			// other html elements
			var bees = 0;
			var deaths = 0;
			var beesDisplay = document.getElementById("heBees");
			var deathsDisplay = document.getElementById("heDeaths");
			
			// [K] keyboard input
			// normal keys
			var ku=false;
			var kd=false;
			var kl=false;
			var kr=false;
			var k1=false;
			var k2=false;
			var k3=false;
			// onpress
			var k1p=false;
			var k2p=false;
			var k3p=false;
			// onrelease
			var k1r=false;
			var k2r=false;
			var k3r=false;
			// detecting keydown & keyup
			document.addEventListener("keydown",function(event){
			if (event.repeat){return;}
			switch(event.keyCode){
			case 38:{ku=true;break;}
			case 40:{kd=true;break;}
			case 37:{kl=true;break;}
			case 39:{kr=true;break;}
			case 65:{k1=true;k1p=true;break;}
			case 83:{k2=true;k2p=true;break;}
			case 13:{k3=true;k3p=true;break;}
			}});
			document.addEventListener("keyup",function(event){
			if (event.repeat){return;}
			switch(event.keyCode){
			case 38:{ku=false;break;}
			case 40:{kd=false;break;}
			case 37:{kl=false;break;}
			case 39:{kr=false;break;}
			case 65:{k1=false;k1r=true;break;}
			case 83:{k2=false;k2r=true;break;}
			case 13:{k3=false;k3r=true;break;}
			}});
			
			
			
			// [DA] Data
			
			// names used in dialogue
			var cname = ["???","guyman","wizard magician man","rian","the face","invisible force","josh","thing 1","thing 2"];
			
			// sprite pallete (rgb)
			// the final color is the background color
			var pal = [
			0,0,0,
			239,228,176,
			181,230,29,
			0,162,232,
			237,28,36,
			255,255,255,
			195,195,195,
			255,174,201,
			163,73,164,
			145,145,255
			];
			
			function switchPal(p){
				switch(p){
				case 0:{pal=[0,0,0,239,228,176,181,230,29,0,162,232,237,28,36,255,255,255,195,195,195,255,174,201,163,73,164,145,145,255];break;}
				case 1:{pal=[141,17,243,255,204,0,115,147,200,145,101,250,17,19,107,198,187,167,142,146,192,255,237,201,0,0,0,0,0,0];break;}
				}
			}
			
			// maps where guyman has collected all bees
			var beeFreeMaps = [
				[0]
			];
			
			// event array (used to check if certain cutscenes and such happened already)
			var ev = [false,false,false,false,false,false,false,false,false,false,false,false];
			
			/*
			EVENT LIST:
			---
			
			0 = guyman fire powers obtained
			1 = spooky land face room passed
			
			*/
			
			// sprites
			
			// 32x sprites (compressed)
			
			// guyman
			var sGMair = [0,12,1,6,0,26,1,1,2,5,1,2,0,23,1,1,2,8,1,2,0,20,1,1,2,11,1,1,0,18,1,1,2,3,1,1,2,5,1,1,2,3,1,1,0,16,1,1,2,15,1,1,0,15,1,1,2,10,1,1,2,4,1,1,0,15,1,1,2,11,1,1,2,3,1,1,0,15,1,1,2,11,1,1,2,3,1,1,0,15,1,1,2,10,1,1,2,4,1,1,0,15,1,1,2,5,1,1,2,9,1,1,0,16,1,1,2,3,1,7,2,3,1,1,0,18,1,1,2,2,1,1,2,8,1,1,0,20,1,1,2,8,1,2,0,22,1,1,5,1,1,1,5,1,1,1,5,1,1,1,5,1,3,1,1,7,0,10,1,6,3,16,1,1,0,8,1,1,3,5,1,1,3,9,1,6,3,2,1,1,0,5,1,2,3,16,1,1,0,5,1,1,3,2,1,1,0,3,1,1,3,3,1,5,3,10,1,1,0,6,1,1,2,3,0,2,1,1,3,2,1,1,0,4,1,1,3,6,1,5,0,6,1,1,2,2,1,1,0,2,1,1,3,1,1,1,0,5,1,1,3,3,1,3,4,5,1,1,0,6,1,2,0,3,1,4,0,5,1,3,4,9,1,1,0,10,1,1,2,2,1,1,0,6,1,1,4,9,1,3,0,9,1,1,2,2,1,1,0,7,1,1,4,2,2,1,1,1,4,3,1,1,2,3,1,1,0,9,1,2,0,9,1,1,2,3,1,4,2,4,1,1,0,20,1,1,2,2,1,1,0,3,1,2,2,2,1,1,0,20,1,1,2,2,1,1,0,4,1,2,2,2,1,2,0,18,1,1,2,2,1,1,0,5,1,1,2,1,5,1,1,1,7,1,1,1,0,17,1,1,6,2,1,1,0,6,1,1,5,1,7,3,1,1,0,16,1,1,5,3,1,1,0,6,1,1,7,3,1,1,0,15,1,1,7,5,1,1,0,5,1,1,7,2,1,1,0,16,1,7,0,6,1,2,0,3];
			var sGMpush = [0,12,1,6,0,26,1,1,2,5,1,2,0,23,1,1,2,8,1,2,0,20,1,1,2,11,1,1,0,18,1,1,2,3,1,1,2,5,1,1,2,3,1,1,0,16,1,1,2,15,1,1,0,15,1,1,2,10,1,1,2,4,1,1,0,15,1,1,2,11,1,1,2,3,1,1,0,15,1,1,2,11,1,1,2,3,1,1,0,15,1,1,2,10,1,1,2,4,1,1,0,15,1,1,2,5,1,1,2,9,1,1,0,16,1,1,2,3,1,7,2,3,1,1,0,18,1,1,2,2,1,1,2,8,1,1,0,20,1,1,2,8,1,2,0,22,1,1,5,1,1,1,5,1,1,1,5,1,1,1,5,1,3,1,1,7,0,10,1,6,3,16,1,1,0,8,1,1,3,5,1,1,3,9,1,6,3,2,1,1,0,5,1,2,3,16,1,1,0,5,1,3,0,3,1,2,3,3,1,5,3,10,1,1,0,4,1,1,2,2,1,1,0,2,1,1,2,2,1,1,3,1,1,1,0,4,1,1,3,6,1,5,0,4,1,1,2,2,1,1,0,2,1,1,2,2,1,2,0,5,1,1,3,3,1,3,4,5,1,1,0,4,1,2,0,4,1,2,0,8,1,3,4,9,1,1,0,20,1,1,4,9,1,3,0,17,1,2,0,1,1,1,4,2,2,1,1,1,4,3,1,1,2,3,1,1,0,15,1,1,7,1,1,1,0,2,1,1,2,3,1,4,2,4,1,1,0,13,1,1,7,1,5,1,1,4,2,3,1,1,0,3,1,2,2,2,1,1,0,12,1,1,7,1,5,1,6,1,2,6,1,1,0,5,1,2,2,2,1,1,0,11,1,1,7,1,1,1,6,1,2,5,1,1,0,7,1,1,6,2,1,1,0,11,1,2,0,1,1,6,0,7,1,2,7,2,1,1,0,26,1,1,6,1,5,3,1,1,0,26,1,1,6,1,5,2,1,1,0,28,1,3,0,6];
			var sGMded = [0,12,1,6,0,26,1,1,6,5,1,2,0,23,1,1,6,8,1,2,0,20,1,1,6,11,1,1,0,18,1,1,6,3,1,2,6,4,1,2,6,2,1,1,0,16,1,1,7,1,6,3,1,2,6,4,1,2,6,3,1,1,0,15,1,1,7,1,6,14,1,1,0,15,1,1,7,1,6,8,1,1,6,5,1,1,0,15,1,1,7,2,6,6,1,3,6,4,1,1,0,15,1,1,7,2,6,13,1,1,0,15,1,1,7,3,6,12,1,1,0,16,1,1,7,4,6,9,1,1,0,18,1,1,7,4,6,1,1,1,6,2,1,1,6,2,1,1,0,20,1,1,7,3,6,1,1,1,6,2,1,1,6,2,1,1,0,21,1,3,6,1,1,1,6,2,1,1,6,2,1,6,0,10,1,6,6,3,1,9,6,3,1,2,0,8,1,1,6,2,1,1,6,2,1,5,6,1,1,1,6,3,1,6,6,2,1,1,0,5,1,2,6,3,1,1,6,2,1,1,6,4,1,1,6,1,1,4,0,5,1,1,6,2,1,1,0,3,1,1,6,1,1,1,6,1,1,10,6,1,1,1,6,3,1,1,0,6,1,2,6,1,1,1,0,2,1,1,6,2,1,1,0,4,1,1,6,3,1,1,6,1,1,6,0,6,1,1,6,1,1,2,0,2,1,1,6,1,1,1,0,5,1,2,6,1,1,5,0,11,1,2,0,3,1,2,6,1,1,1,0,5,1,3,0,20,1,1,6,1,1,2,0,8,1,2,0,6,1,2,0,11,1,2,0,8,1,1,6,2,1,1,0,4,1,1,6,2,1,1,0,21,1,1,6,2,1,1,0,3,1,1,6,2,1,2,0,21,1,1,6,1,1,1,0,4,1,2,6,2,1,1,0,20,1,3,0,5,1,2,6,2,1,1,0,19,1,1,6,1,1,1,0,6,1,1,6,1,1,1,6,1,1,1,0,18,1,1,6,1,1,2,0,6,1,1,6,1,1,1,6,1,1,1,0,17,1,1,6,3,1,1,0,5,1,1,6,2,1,2,0,16,1,1,6,1,1,1,6,1,1,1,6,1,1,1,0,4,1,1,6,3,1,1,0,16,1,7,0,5,1,3,0,3];
			var sGMidle = [0,12,1,6,0,26,1,1,2,5,1,2,0,23,1,1,2,8,1,2,0,20,1,1,2,11,1,1,0,18,1,1,2,3,1,1,2,5,1,1,2,3,1,1,0,16,1,1,2,15,1,1,0,15,1,1,2,10,1,1,2,4,1,1,0,15,1,1,2,11,1,1,2,3,1,1,0,15,1,1,2,11,1,1,2,3,1,1,0,15,1,1,2,10,1,1,2,4,1,1,0,15,1,1,2,5,1,1,2,9,1,1,0,16,1,1,2,3,1,7,2,3,1,1,0,18,1,1,2,2,1,1,2,8,1,1,0,20,1,1,2,8,1,2,0,22,1,1,5,1,1,1,5,1,1,1,5,1,1,1,5,1,1,1,0,21,1,2,3,8,1,1,0,20,1,1,3,1,1,1,3,8,1,1,0,19,1,1,3,2,1,1,3,8,1,1,0,18,1,1,3,2,1,1,3,9,1,1,0,17,1,1,3,2,1,2,3,9,1,2,0,16,1,3,0,1,1,11,3,1,1,1,0,14,1,1,2,2,1,1,0,1,1,1,4,9,1,2,2,1,1,1,0,13,1,1,2,2,1,1,0,1,1,1,4,9,1,1,2,2,1,1,0,14,1,2,0,2,1,1,4,4,1,2,4,3,1,3,0,19,1,1,4,4,1,3,4,2,1,1,0,21,1,2,2,1,1,3,0,1,1,2,2,1,1,1,0,22,1,1,2,1,1,1,0,3,1,1,2,2,1,1,0,22,1,1,2,1,1,1,0,3,1,1,2,2,1,1,0,22,1,1,2,1,1,1,0,3,1,1,2,2,1,1,0,22,1,1,5,1,1,1,0,3,1,1,5,2,6,1,1,1,0,20,1,1,6,3,1,1,0,2,1,1,6,4,1,1,0,19,1,5,0,2,1,6,0,9];
			var sGMrun1 = [0,13,1,5,0,26,1,1,2,5,1,2,0,23,1,1,2,8,1,2,0,20,1,1,2,11,1,1,0,18,1,1,2,10,1,1,2,2,1,1,0,17,1,1,2,14,1,1,0,16,1,1,2,14,1,2,0,15,1,1,2,16,1,1,0,14,1,1,2,16,1,1,0,14,1,1,2,7,1,1,2,6,1,2,0,15,1,1,2,7,1,6,2,1,1,1,0,17,1,1,2,5,1,1,2,6,1,1,0,19,1,1,2,10,1,1,0,21,1,1,2,7,1,2,0,18,1,5,5,1,1,1,5,1,1,1,5,1,1,1,5,1,1,1,0,17,1,2,3,12,1,1,0,16,1,1,3,14,1,1,0,15,1,1,3,2,1,6,3,7,1,2,0,5,1,2,0,6,1,2,3,1,1,1,0,4,1,1,3,8,1,1,3,1,1,1,0,3,1,1,2,2,1,1,0,4,1,1,2,2,1,1,0,5,1,1,3,8,1,1,3,2,1,4,2,2,1,1,0,4,1,1,2,2,1,1,0,5,1,11,3,5,1,2,0,6,1,2,0,6,1,1,4,8,1,1,0,1,1,6,0,15,1,1,4,8,1,1,0,23,1,1,4,5,1,1,4,1,1,3,0,21,1,1,4,5,1,3,2,2,1,1,0,13,1,6,0,2,1,6,0,1,1,1,2,3,1,1,0,12,1,1,6,4,1,1,0,2,1,1,2,2,1,1,0,4,1,1,2,3,1,1,0,12,1,2,5,2,1,3,2,3,1,1,0,5,1,1,2,2,1,1,0,14,1,1,2,6,1,1,0,7,1,1,5,2,1,2,0,13,1,6,0,8,1,1,6,3,1,1,0,27,1,5,0,36];
			var sGMrun2 = [0,45,1,7,0,24,1,1,2,7,1,2,0,21,1,1,2,10,1,1,0,19,1,1,2,12,1,1,0,17,1,1,2,8,1,1,2,3,1,2,0,17,1,1,2,14,1,2,0,15,1,1,2,16,1,1,0,14,1,1,2,13,1,3,0,15,1,1,2,6,1,1,2,8,1,1,0,15,1,1,2,6,1,8,2,1,1,1,0,15,1,1,2,5,1,1,2,2,1,1,2,1,1,1,2,3,1,1,0,17,1,1,2,12,1,1,0,19,1,1,2,10,1,1,0,20,1,1,2,9,1,1,0,21,1,2,5,1,1,1,5,1,1,1,5,1,1,1,5,1,1,1,0,21,1,2,3,8,1,1,0,20,1,1,3,1,1,1,3,5,1,1,3,2,1,1,0,19,1,1,3,2,1,1,3,2,1,1,3,3,1,1,3,1,1,1,0,19,1,1,3,2,1,1,3,3,1,1,3,3,1,4,0,17,1,4,3,4,1,1,3,3,1,1,2,2,1,1,0,16,1,1,2,2,1,7,3,2,1,1,2,2,1,1,0,16,1,1,2,2,1,1,4,2,1,1,4,3,1,5,0,18,1,3,4,2,1,1,4,5,1,1,0,22,1,1,4,2,1,1,4,5,1,1,0,23,1,9,0,23,1,1,2,3,1,1,2,3,1,1,0,20,1,3,5,1,2,3,1,2,2,2,1,1,0,20,1,1,6,2,5,2,2,1,1,1,0,1,1,1,2,2,1,1,0,20,1,1,6,3,1,2,0,3,1,1,5,2,1,2,0,19,1,1,6,3,1,1,0,3,1,1,6,4,1,1,0,19,1,4,0,3,1,6,0,8];
			
			
			// other
			var sBird1 = [0,24,1,1,0,30,1,2,0,29,1,1,0,30,1,1,0,29,1,2,0,30,1,1,0,15,1,4,0,10,1,2,0,6,1,3,0,6,1,1,5,3,1,3,0,7,1,2,0,4,1,3,0,7,1,2,5,6,1,2,0,6,1,1,0,2,1,3,0,10,1,4,5,6,1,1,0,2,1,7,0,16,1,3,5,3,1,3,5,7,1,2,0,2,1,7,0,8,1,2,5,1,1,2,5,9,1,2,5,5,1,4,0,9,1,2,5,15,1,3,0,11,1,2,5,14,1,2,0,14,1,3,5,11,1,3,0,14,1,2,5,12,1,2,0,16,1,1,5,2,6,3,5,4,6,2,5,2,1,2,0,16,1,1,5,2,6,1,1,1,6,1,5,3,6,4,5,2,1,1,0,16,1,1,5,1,6,4,5,3,6,1,1,1,6,2,5,2,1,1,0,16,1,1,5,2,6,3,5,1,2,3,6,3,5,2,1,1,0,16,1,1,5,5,2,3,5,5,1,1,0,17,1,2,5,3,2,3,5,5,1,2,0,18,1,2,5,2,2,3,5,5,1,1,0,20,1,2,2,3,5,3,1,3,0,22,2,3,1,4,0,24,2,3,0,29,2,2,0,29,2,2,0,150];
			var sBird2 = [0,53,1,1,0,30,1,1,0,30,1,2,0,30,1,1,0,30,1,2,0,9,1,2,0,19,1,1,0,9,1,2,0,19,1,2,0,8,1,2,0,20,1,1,0,8,1,2,0,9,1,4,0,8,1,1,0,7,1,1,0,9,1,1,5,4,1,10,0,5,1,2,0,9,1,2,5,4,1,2,5,7,1,3,0,1,1,2,0,11,1,1,5,4,1,2,5,10,1,3,0,12,1,1,5,3,1,1,5,13,1,3,0,11,1,1,5,3,1,1,5,14,1,3,0,10,1,1,5,2,1,2,5,15,1,1,5,1,1,1,0,9,1,1,5,3,1,1,6,4,5,11,1,1,5,1,1,2,0,8,1,1,5,2,1,2,6,2,1,1,6,1,5,11,1,1,5,2,1,2,0,7,1,1,5,2,1,2,5,1,6,3,5,5,6,3,5,3,1,1,5,4,0,7,1,1,5,2,1,2,5,9,6,1,1,1,6,1,5,3,1,2,5,3,1,1,0,6,1,1,5,2,1,2,5,9,6,3,5,3,1,2,5,3,1,1,0,6,1,1,5,2,1,3,5,13,1,3,5,3,1,2,0,5,1,1,5,2,1,1,0,1,1,1,5,3,2,3,5,6,1,2,0,2,1,1,5,3,1,1,0,5,1,1,5,2,1,1,0,2,1,2,5,1,2,3,5,5,1,2,0,3,1,1,5,3,1,1,0,6,1,1,5,1,1,1,0,4,2,3,1,2,5,2,1,2,0,5,1,1,5,3,1,1,0,6,1,3,0,3,2,3,0,3,1,2,0,7,1,1,5,2,1,1,0,8,1,2,0,2,2,3,0,13,1,2,5,1,1,1,0,11,2,3,0,15,1,3,0,11,2,2,0,16,1,2,0,101];
			var sFace = [0,102,1,16,0,15,1,3,4,1,1,2,4,11,1,5,0,9,1,1,4,5,1,1,4,16,1,2,0,6,1,2,4,2,1,1,4,20,1,2,0,5,1,1,4,4,1,2,4,14,1,3,4,2,1,2,0,4,1,1,4,5,1,2,4,11,1,4,4,4,1,2,0,3,1,1,4,6,1,2,4,9,1,2,5,1,6,1,1,2,4,4,1,1,0,2,1,1,4,6,1,1,4,1,1,2,4,7,1,2,6,2,1,1,6,1,1,2,4,3,1,1,0,2,1,1,4,4,1,7,4,6,1,3,6,3,5,1,1,1,4,3,1,1,0,2,1,1,4,4,1,1,6,2,5,1,1,2,4,9,1,2,5,1,6,1,1,2,4,3,1,1,0,2,1,1,4,3,1,2,6,1,1,1,6,2,1,1,4,10,1,4,4,3,1,2,0,1,1,1,4,4,1,2,5,1,6,3,1,1,4,4,1,3,4,10,1,2,0,1,1,1,4,5,1,5,4,7,1,2,4,9,1,2,0,1,1,1,4,18,1,1,4,9,1,2,0,1,1,1,4,18,1,1,4,9,1,2,0,1,1,1,4,10,1,5,4,3,1,3,4,7,1,2,0,1,1,1,4,9,1,2,4,3,1,1,4,3,1,1,4,1,1,2,4,6,1,2,0,1,1,1,4,9,1,1,4,1,1,2,4,3,1,2,4,3,1,1,4,7,1,1,0,1,1,1,4,11,1,2,4,2,1,2,4,3,1,2,4,7,1,1,0,2,1,1,4,28,1,1,0,2,1,1,4,28,1,1,0,2,1,1,4,28,1,1,0,2,1,1,4,11,1,3,4,3,1,7,4,4,1,1,0,2,1,2,4,7,1,4,4,1,1,2,4,1,1,2,4,5,1,3,4,2,1,1,0,3,1,1,4,5,1,3,4,5,1,2,4,9,1,2,4,1,1,1,0,3,1,2,4,25,1,2,0,4,1,5,4,16,1,6,0,8,1,1,0,1,1,17,0,38];
			var sBlood = [0,41,5,1,0,27,5,1,0,18,5,1,0,15,5,2,0,29,5,1,0,29,5,3,0,7,5,1,0,7,5,1,0,13,5,2,0,2,5,1,0,4,5,2,0,10,5,1,0,9,5,1,0,1,5,1,0,2,5,1,0,7,5,1,0,9,5,2,0,6,5,1,0,2,5,1,0,4,5,2,0,3,5,1,0,1,5,2,0,1,5,1,0,19,5,3,0,2,5,2,0,2,5,1,0,1,5,1,0,19,5,1,0,1,5,1,0,1,5,4,0,1,5,1,0,1,5,1,0,3,5,2,0,10,5,1,0,5,5,9,0,1,5,1,0,2,5,3,0,10,5,1,0,4,5,8,0,1,5,3,0,2,5,1,0,15,5,1,0,1,5,13,0,1,5,1,0,14,5,3,0,1,5,1,0,2,5,6,0,1,5,4,0,14,5,4,0,2,5,12,0,13,5,2,0,1,5,1,0,1,5,11,0,1,5,3,0,11,5,2,0,1,5,1,0,1,5,4,0,1,5,8,0,1,5,1,0,10,5,1,0,3,5,2,0,1,5,7,0,1,5,5,0,13,5,1,0,2,5,10,0,1,5,9,0,5,5,1,0,8,5,1,0,1,5,11,0,2,5,1,0,13,5,2,0,1,5,4,0,1,5,6,0,3,5,1,0,12,5,1,0,6,5,3,0,2,5,8,0,10,5,2,0,11,5,4,0,22,5,1,0,7,5,1,0,9,5,1,0,3,5,1,0,17,5,1,0,7,5,1,0,2,5,1,0,19,5,2,0,1,5,1,0,8,5,1,0,6,5,1,0,13,5,1,0,19,5,1,0,44,5,4,0,4,5,1,0,19,5,1,0,7,5,1,0,43];
			var sRyan = [0,14,3,1,0,1,5,1,3,1,0,27,3,1,0,1,1,1,0,1,6,1,0,28,1,1,8,1,1,1,0,28,1,1,6,1,8,1,6,1,1,1,0,26,1,1,6,1,8,1,6,1,8,1,6,1,1,1,0,25,1,7,0,22,1,3,2,6,1,3,0,19,1,2,2,10,1,2,0,16,1,2,2,14,1,1,0,15,1,1,2,4,1,1,2,11,1,1,0,13,1,1,2,13,1,1,2,3,1,1,0,13,1,1,2,18,1,1,0,11,1,1,2,19,1,1,0,11,1,1,2,19,1,2,0,10,1,1,2,6,1,1,2,9,1,1,2,3,1,1,0,10,1,1,2,5,1,1,2,11,1,1,2,1,1,1,0,12,1,1,2,4,1,13,2,1,1,1,0,12,1,2,2,3,1,1,2,11,1,1,2,1,1,1,0,13,1,2,2,3,1,1,2,9,1,1,2,1,1,1,0,15,1,2,2,13,1,2,0,16,1,3,2,9,1,3,0,19,1,4,2,2,1,5,0,23,1,5,5,1,1,1,0,25,1,1,5,5,1,1,0,17,1,9,5,5,1,8,0,10,1,1,2,2,5,5,1,1,5,5,1,1,5,4,2,2,1,1,0,10,1,9,5,5,1,8,0,18,1,1,5,5,1,1,0,25,1,7,0,25,1,1,4,5,1,1,0,23,1,4,5,1,1,1,5,1,1,4,0,20,1,1,7,5,1,1,7,4,1,1,0,11];
			var sDemon1 = [0,6,1,1,0,22,1,1,0,8,1,2,0,19,1,3,0,8,1,1,6,1,1,1,0,17,1,2,6,1,1,1,0,9,1,1,6,1,1,1,0,15,1,2,6,1,7,1,1,1,0,9,1,1,7,1,6,1,1,1,0,4,1,5,0,4,1,1,6,2,7,1,1,1,0,10,1,2,7,1,6,1,1,4,5,4,1,6,6,2,7,1,1,1,0,11,1,2,6,3,1,1,5,7,1,1,6,4,7,1,1,1,0,13,1,1,7,2,1,1,5,9,1,2,7,2,1,1,0,15,1,3,6,1,1,1,6,1,5,3,6,1,1,1,6,1,5,1,1,3,0,17,1,2,6,2,5,5,6,2,5,1,1,1,0,19,1,1,5,11,1,1,0,19,1,1,5,3,1,2,5,6,1,1,0,19,1,1,5,2,1,1,5,8,1,1,0,19,1,1,5,10,1,2,0,19,1,2,5,9,1,1,0,21,1,10,0,22,1,2,5,6,1,1,0,21,1,4,5,6,1,2,0,18,1,2,5,3,1,1,5,6,1,1,5,1,1,1,0,17,1,1,5,2,1,1,0,1,1,1,5,6,1,1,5,1,1,1,0,18,1,1,5,2,1,2,5,6,1,1,5,1,1,1,0,19,1,1,5,2,1,1,5,6,1,1,5,1,1,1,0,20,1,3,5,6,1,1,5,1,1,1,0,19,1,1,5,2,1,1,5,6,1,1,5,2,1,1,0,18,1,1,5,2,1,1,5,2,1,3,5,1,1,1,5,2,1,1,0,18,1,4,5,2,1,1,0,1,1,1,5,2,1,3,0,21,1,1,5,2,1,1,0,1,1,1,5,2,1,1,0,23,1,1,5,2,1,1,0,1,1,1,5,2,1,1,0,23,1,1,5,2,1,1,0,1,1,1,5,2,1,1,0,23,1,1,5,2,1,1,0,1,1,1,5,2,1,1,0,21,1,1,5,4,1,1,0,1,1,1,5,3,1,2,0,19,1,1,6,1,7,1,6,1,7,1,1,1,0,1,1,1,6,1,7,1,6,1,7,1,1,1,0,8];
			var sDemon2 = [0,21,1,2,0,29,1,1,6,1,1,1,0,28,1,2,6,1,1,1,0,27,1,1,6,3,1,1,0,24,1,4,6,3,1,1,0,22,1,2,5,2,1,1,6,3,7,1,1,1,0,22,1,1,5,3,1,1,6,2,7,1,1,2,0,21,1,1,5,3,1,1,7,1,6,2,7,1,1,3,0,20,1,2,6,1,5,2,1,1,7,2,1,2,5,1,1,1,0,19,1,2,6,2,5,2,1,4,5,2,1,1,0,19,1,1,5,11,1,1,0,19,1,6,5,6,1,1,0,19,1,1,5,11,1,1,0,19,1,1,5,10,1,2,0,19,1,2,5,9,1,1,0,10,1,2,0,9,1,10,0,10,1,1,5,2,1,11,5,6,1,1,0,11,1,1,5,2,1,2,5,8,1,1,5,6,1,1,0,12,1,2,5,2,1,9,5,6,1,12,0,2,1,1,5,14,1,1,5,13,7,1,0,2,1,15,5,14,6,1,0,13,1,1,5,10,1,8,0,13,1,2,5,15,7,1,1,1,0,15,1,2,5,13,6,1,1,1,0,17,1,12,5,1,7,1,1,1,0,29,5,1,6,1,1,1,0,29,1,3,0,160];
			var sWizard = [0,12,1,5,0,27,1,1,9,4,1,2,0,24,1,1,9,1,2,1,9,3,2,1,1,2,0,17,1,6,9,8,1,6,0,11,1,1,9,5,2,1,9,3,1,4,9,5,2,1,1,1,0,11,1,21,0,17,1,1,2,8,1,1,0,22,1,1,2,1,5,1,3,1,2,2,3,1,5,1,2,1,1,1,0,22,1,1,2,8,1,1,0,22,1,1,2,8,1,1,0,5,1,3,0,14,1,1,7,2,2,5,7,1,1,1,0,4,1,1,5,1,6,1,5,1,1,1,0,13,1,1,7,8,1,1,0,4,1,1,5,3,1,1,0,11,1,4,7,1,2,1,1,2,7,3,1,1,0,5,1,1,5,1,1,1,0,12,1,1,9,3,7,7,1,2,0,3,1,5,0,11,1,1,9,3,1,1,7,5,1,1,9,1,1,1,0,3,1,1,4,1,6,1,4,1,1,1,0,11,1,1,9,3,5,1,1,1,7,3,1,1,9,2,1,1,0,3,1,5,0,10,1,2,9,1,5,1,9,1,5,1,1,1,7,3,1,1,9,2,1,1,0,5,1,1,0,12,1,1,9,5,1,1,7,1,1,1,9,4,1,1,0,5,1,1,0,12,1,1,9,5,1,1,9,5,5,1,1,1,0,5,1,1,0,12,1,1,9,1,5,1,9,8,5,2,1,1,0,5,1,1,0,12,1,1,9,1,5,2,9,6,5,1,9,1,5,1,1,1,0,5,1,1,0,12,1,1,9,1,5,2,9,5,5,1,9,2,5,1,1,1,0,5,1,1,0,12,1,1,9,1,5,2,9,1,5,1,9,4,5,1,9,1,5,2,1,1,0,4,1,1,0,12,1,1,9,1,5,1,9,8,5,3,1,1,0,4,1,1,0,12,1,1,9,1,5,1,9,3,5,2,9,1,5,1,9,2,5,2,1,1,0,4,1,1,0,11,1,2,9,1,5,1,9,3,5,1,9,5,5,3,1,1,0,3,1,1,0,10,1,2,9,2,5,1,9,5,5,1,9,3,5,3,1,1,0,3,1,1,0,10,1,1,9,6,5,2,9,1,5,2,9,2,5,3,1,1,0,3,1,1,0,9,1,1,9,4,5,3,9,2,5,1,9,3,5,4,1,1,0,3,1,1,0,8,1,2,9,1,5,6,9,2,5,1,9,1,5,7,1,1,0,2,1,1,0,7,1,2,9,2,5,17,1,1,0,2,1,1,0,5,1,27,0,5];
			
			// 32x tiles (compressed) (used in map)
			var sBrick = [7,63,1,1,7,2,5,14,1,1,5,13,1,2,7,2,5,14,1,1,5,13,1,2,7,2,5,14,1,1,5,13,1,2,7,2,5,14,1,1,5,13,1,2,7,2,5,14,1,1,5,13,1,2,7,30,1,2,7,2,5,6,1,1,5,14,1,1,5,6,1,2,7,2,5,6,1,1,5,14,1,1,5,6,1,2,7,2,5,6,1,1,5,14,1,1,5,6,1,2,7,2,5,6,1,1,5,14,1,1,5,6,1,2,7,2,5,6,1,1,5,14,1,1,5,6,1,2,7,30,1,2,7,2,5,14,1,1,5,13,1,2,7,2,5,14,1,1,5,13,1,2,7,2,5,14,1,1,5,13,1,2,7,2,5,14,1,1,5,13,1,2,7,2,5,14,1,1,5,13,1,2,7,30,1,2,7,2,5,6,1,1,5,14,1,1,5,6,1,2,7,2,5,6,1,1,5,14,1,1,5,6,1,2,7,2,5,6,1,1,5,14,1,1,5,6,1,2,7,2,5,6,1,1,5,14,1,1,5,6,1,2,7,2,5,6,1,1,5,14,1,1,5,6,1,2,7,30,1,2,7,2,5,14,1,1,5,13,1,2,7,2,5,14,1,1,5,13,1,2,7,2,5,14,1,1,5,13,1,2,7,2,5,14,1,1,5,13,1,2,7,2,1,30,7,1,1,31];
			var sSpikes = [1,2,0,31,1,2,0,14,1,2,0,5,1,1,0,8,1,3,0,13,1,2,0,4,1,2,0,6,1,1,0,2,1,1,6,1,1,2,0,10,1,3,0,4,1,2,0,4,1,3,0,2,1,2,6,1,1,3,0,8,1,1,6,1,1,2,0,3,1,2,0,2,1,3,6,1,1,1,0,3,1,2,6,2,1,2,0,6,1,2,6,2,1,1,0,2,1,3,0,1,1,2,6,3,1,1,0,4,1,2,7,3,1,2,0,4,1,1,6,1,7,2,1,1,0,2,1,1,6,1,1,2,6,2,7,2,1,2,0,5,1,1,7,2,1,1,7,1,1,3,0,2,1,1,6,1,7,3,1,1,0,1,1,1,7,1,1,1,6,1,7,4,1,1,0,7,1,5,7,1,1,5,7,3,1,5,7,5,1,1,0,5,1,4,6,2,1,5,6,1,1,7,6,1,1,1,7,4,1,2,0,4,1,2,6,3,1,1,7,1,6,3,1,2,7,1,6,4,1,2,6,1,1,7,0,6,1,2,7,2,1,2,7,3,1,1,6,1,1,2,7,3,6,1,1,1,7,1,6,1,1,4,6,1,1,1,0,8,1,2,7,1,1,2,7,1,1,2,7,1,6,1,1,3,7,1,1,2,7,2,6,1,1,2,6,1,1,2,0,9,1,6,7,3,6,2,1,3,7,3,1,2,6,1,7,1,1,1,0,6,1,5,6,1,1,5,7,3,1,4,7,2,1,3,7,2,1,1,0,3,1,4,6,4,7,1,1,3,6,1,1,6,7,3,1,2,6,1,1,1,7,2,1,1,0,3,1,1,6,3,7,4,1,4,7,1,6,2,1,2,7,2,1,1,7,1,1,2,6,1,7,1,1,2,7,1,1,2,0,2,1,2,7,5,1,5,7,3,1,4,7,1,1,2,6,1,7,2,1,1,7,2,6,1,1,2,0,2,1,3,7,1,1,4,6,1,1,3,7,1,1,2,6,2,1,4,7,2,1,3,7,2,6,1,1,2,0,3,1,5,6,2,1,5,6,1,7,2,6,1,1,3,7,2,1,1,0,1,1,5,0,5,1,4,7,2,6,1,1,3,6,1,7,3,1,7,0,10,1,2,6,2,1,3,7,1,1,4,7,3,1,1,6,2,1,3,6,1,1,1,0,7,1,3,7,3,1,1,7,1,1,3,7,1,1,4,7,1,1,1,7,2,6,1,1,1,7,2,1,2,0,5,1,14,7,1,1,4,7,2,1,2,7,2,6,1,1,1,0,12,1,1,6,3,1,17,0,11,1,1,6,1,7,2,1,2,6,3,1,1,6,1,1,3,6,3,7,1,1,1,6,1,1,2,0,9,1,2,7,2,1,3,7,3,6,1,1,6,7,2,1,1,7,1,1,3,0,8,1,1,6,1,7,1,1,2,0,1,1,2,7,3,1,3,0,2,1,5,6,1,7,1,1,1,0,8,1,1,7,1,1,2,0,3,1,1,7,3,1,2,0,5,1,3,7,2,1,2,0,7,1,3,0,4,1,2,7,1,1,2,0,8,1,5,0,7,1,2,0,6,1,3,0,13,1,1,0,7,1,1,0,7,1,2,0,16];
			var sGrass = [3,204,1,1,3,2,1,1,3,7,1,1,3,5,1,1,3,6,1,2,3,6,1,2,3,1,1,3,3,5,1,2,3,4,1,2,3,4,1,1,5,2,1,2,3,3,1,1,5,2,1,1,5,3,1,2,3,2,1,1,5,1,1,1,3,3,1,1,5,1,1,1,3,4,1,1,5,4,1,3,5,9,1,2,5,3,1,1,3,2,1,1,5,2,1,1,3,1,1,2,5,23,1,1,3,1,1,1,5,2,1,2,5,26,1,1,5,3,1,1,5,99,2,4,5,209,2,4,5,177,2,3,5,144];
			var sDirt = [5,147,2,7,5,329,2,4,5,209,2,4,5,177,2,3,5,144];
			
			// 8x sprites (uncompressed)
			var sFlame = [0,5,0,0,0,5,5,0,0,5,8,5,0,5,5,0,0,0,5,5,5,5,5,0,5,5,8,6,5,8,5,0,5,8,6,6,8,5,8,0,5,5,8,6,8,5,0,0,0,5,5,8,5,5,8,0,8,0,0,5,5,0,0,0];
			var sBee = [4,6,6,0,0,0,0,0,0,4,6,6,0,0,1,0,0,0,4,6,1,2,0,0,1,2,7,2,7,2,1,1,0,2,1,2,1,2,1,5,1,2,1,2,1,2,1,1,0,0,1,2,1,2,0,0,0,0,0,0,0,0,0,0];
			var sStar = [6,0,0,0,2,0,0,0,0,0,0,2,2,0,0,0,0,0,0,2,6,0,0,0,2,2,6,6,6,2,2,0,0,2,2,6,6,6,2,2,0,0,0,6,2,0,0,0,0,0,0,2,2,0,0,0,0,0,0,2,0,0,0,6];
			
			// random size sprites
			// 18x10
			var sScarf = [0,11,5,1,0,6,5,1,0,9,5,1,7,1,5,1,0,6,5,1,0,7,5,1,0,1,5,1,0,1,5,1,0,1,5,1,0,2,5,1,7,1,5,1,0,1,5,1,0,3,5,1,7,1,5,1,0,1,5,1,7,1,5,1,0,1,5,1,0,1,7,1,5,1,0,1,5,1,0,1,5,1,0,1,5,1,0,1,5,1,7,1,5,1,0,1,5,1,0,1,5,1,7,1,5,2,0,1,5,1,0,1,5,1,7,1,5,1,7,1,5,1,0,1,5,3,7,1,5,1,7,1,5,1,0,1,5,2,7,1,5,1,0,1,5,1,0,1,5,1,7,1,5,1,0,2,5,2,0,1,5,1,0,1,5,1,0,1,5,2,0,1,5,1,7,1,5,1,0,1,5,1,0,7,5,1,7,1,0,4,5,2,7,1,5,1,0,8,5,2,0,5,5,2,0,10,5,1];
			// 12x12
			var sCorn = [0,6,5,1,2,1,0,6,5,1,2,1,5,1,1,1,0,5,2,1,5,1,2,1,1,1,0,5,5,1,2,1,5,1,1,1,0,5,2,1,5,1,2,1,1,1,0,4,2,1,5,1,2,1,1,1,0,2,3,1,0,2,5,1,2,1,5,1,1,1,0,2,1,1,3,1,1,1,2,1,5,1,2,1,1,1,0,3,1,1,2,1,5,1,2,1,1,1,0,1,1,1,3,1,0,2,5,1,3,2,1,2,3,1,1,1,3,1,1,1,2,1,5,1,2,1,3,2,1,1,0,1,1,1,3,5,1,1,3,1];
			// 5x5
			var sDust = [0,1,7,1,0,7,7,1,0,5,1,1,0,1,7,1,0,5,1,1,0,1];
			// 16x6
			var sYay = [5,1,0,3,5,1,0,2,5,2,0,2,5,1,0,3,5,2,0,3,5,1,0,1,5,1,0,2,5,1,0,1,5,1,0,3,5,1,0,1,5,1,0,1,5,1,0,2,5,1,0,2,5,1,0,2,5,1,0,1,5,1,0,3,5,1,0,3,5,4,0,3,5,1,0,4,5,1,0,3,5,1,0,2,5,1,0,3,5,1,0,4,5,1,0,3,5,1,0,2,5,1,0,3,5,1,0,2];
			// 16x16
			var sCloud = [0,9,6,2,0,12,6,5,0,7,6,2,0,1,6,7,0,4,6,13,0,3,6,14,0,1,6,15,0,1,6,86,0,1,6,5,0,1,6,2,0,2,6,5,0,2,6,3,0,7,6,2,0,44];
			var sSign = [6,17,2,14,5,1,6,1,2,14,5,1,6,1,2,1,1,1,2,2,1,1,2,3,1,3,2,3,5,1,6,1,2,1,1,1,2,2,1,1,2,2,1,1,2,3,1,1,2,2,5,1,6,1,2,1,1,1,2,2,1,1,2,2,1,1,2,3,1,1,2,2,5,1,6,1,2,2,1,3,2,2,1,1,2,3,1,1,2,2,5,1,6,1,2,4,1,1,2,3,1,3,2,2,1,1,5,1,6,1,2,1,1,3,2,10,5,1,6,1,2,14,5,1,6,1,5,15,0,7,5,1,1,1,0,14,5,1,1,1,0,14,5,1,1,1,0,14,5,1,1,1,0,14,5,1,1,1,0,7];
			
			// map
			var map = [0,300];
			
			// uncompressing map
			function uc(m){
				var newMap = [];
				
				var i = 0;
				var num = m[i];
				var count = m[i+1];
				
				while (i < m.length){
					while (count > 0){
						newMap.push(num);
						count --;
					}
					
					
					i += 2;
					num = m[i];
					count = m[i+1];
				}
				
				return newMap;
			}
			
			// compressing/re-compressing map
			function rc(m){
			var i = 0;
			var color = m[i];
			var count = 1;
			var newMap = [];

			while (i < m.length){
			// increasing index to check
			i ++;
			// checking if color is the same as currently set color
			if (m[i] == color){
			// if so, increase the current count of this number
			count ++;
			} else {
			// if not, add color & count to new map
			newMap.push(color,count);
			// then start to collect data on the next color
			count = 1;
			color = m[i];
			}
			}
			return newMap;
			}
			
			// Loading Maps
			
			// Save Variables (used to restore variables for guyman when the next room is entered)
			var savex = 0;
			var savey = 0;
			var savehs = 0;
			var savevs = 0;
			var savejs = 0;
			var savef = 0;
			var mapRestart = false;
			var gmp = false;
			
			function lm(mx,my){
				// Clearing log
				ls("");
				
				// Syncing level # with map #
				mapx += mx;
				mapy += my;
				
				// Checking if guyman is present
				gmp = true;
				if (oGM == null){gmp = false;}
				
				// Deleting object arrays
				delete ptcl;
				delete inst;
				
				ptcl = [];
				inst = [];
				
				currentInst = 0;
				
				// Getting Map Data (map array & executing other map specific statements)
				getMapData(mapx,mapy);
				
				// uncompressing map
				map = uc(map);
				
				// processing map (adding objects at specific map indexes)
				mapProcess();
				
				
				
				// adding guyman if he doesn't exist yet
				if (gmp){
					oGM = new makeInst(savex,savey,1);
					
					// if restarting a map, do not restore speeds & jump state
					if (!mapRestart){
						oGM.hs = savehs;
						oGM.vs = savevs;
						oGM.jumpState = savejs;
						oGM.facing = savef;
					}
					mapRestart = false;
				}
				
				// unstuck-ening guyman if in wall
				unstuckGM();
			}
			
			// [MP] maps
			function getMapData(mx,my){
				switch(my){
				case 0:{
					switch(mx){
					case 1:{map=[1,7,0,5,3,1,1,3,0,2,1,6,3,3,0,5,3,1,1,3,0,2,1,4,0,10,3,1,1,3,0,2,1,2,0,12,3,1,1,3,0,2,1,2,0,14,1,2,0,2,1,2,0,18,1,2,0,8,3,3,0,7,1,2,0,8,2,3,0,7,1,2,0,8,1,3,0,7,1,2,0,8,1,3,0,7,1,2,0,8,1,3,0,7,1,2,0,9,1,2,0,7,1,2,0,2,5,1,0,6,1,2,0,4,4,1,0,2,1,2,2,9,1,2,2,7,1,22];break;}
					case 2:{map=[1,22,3,1,0,16,1,3,3,1,0,14,5,1,0,1,1,3,3,1,0,12,2,4,1,3,3,1,0,7,3,5,1,7,3,1,0,3,3,4,1,12,3,1,0,2,3,1,1,9,0,4,1,3,3,1,0,2,3,1,1,4,0,9,1,3,3,1,0,16,1,3,3,1,0,16,1,3,3,1,0,14,4,1,0,1,1,4,3,2,0,10,2,4,1,6,3,2,0,8,1,12,3,8,1,25];break;}
					case 3:{map=[1,1,5,1,0,16,3,1,1,7,0,3,1,16,3,1,0,3,3,4,1,11,3,1,0,4,3,1,0,3,3,2,1,9,3,1,0,4,3,1,0,5,3,1,1,7,3,1,0,5,3,1,0,6,3,1,1,7,3,1,0,4,3,2,0,3,4,1,0,1,3,1,1,7,3,1,0,9,2,1,0,1,3,1,1,7,3,1,0,11,3,1,1,8,3,1,0,10,3,1,1,9,3,3,0,5,3,2,1,13,3,5,1,66];break;}
					case 4:{map=[1,47,0,13,1,1,0,19,1,1,0,19,1,1,2,1,0,18,1,2,0,16,2,2,1,2,2,2,0,14,1,6,0,10,2,4,1,6,0,10,1,10,0,6,2,2,0,2,1,10,0,6,1,2,0,2,1,10,2,2,1,1,2,1,1,1,2,1,1,50];
					if(!gmp){oGM=new makeInst(64,192,1);}
					makeSign(480,224,["this sign does not actually say yo."]);
					ls("$n5This is guyman. You are a guy and man$b$bcontrols:$b$bArrow Keys = move$bA = jump");
					if(ev[0]){new makeInst(128,160,10); ev[0]=false;}
					break;}
					case 5:{map=[1,24,0,2,1,3,3,3,1,8,0,12,3,1,1,3,0,17,3,1,1,2,0,17,3,1,1,2,0,17,3,1,1,2,0,4,2,4,0,10,1,2,0,4,1,4,0,16,1,4,0,14,1,1,2,1,1,2,0,16,1,4,0,3,1,3,0,5,1,3,0,2,1,4,0,3,1,2,0,7,1,2,0,2,1,4,0,16,1,4,3,16,1,22];break;}
					case 6:{map=[1,40,0,7,1,2,0,6,1,2,0,10,3,2,0,58,3,2,0,18,1,2,0,11,2,7,1,2,0,11,1,9,0,11,1,8,3,1,0,11,1,9,0,4,2,7,1,9,0,4,3,1,1,15,3,4,1,27];
					if(!GMpowers){new makeInst(566,320,5);}
					break;}
					case 7:{map=[1,40,0,18,1,2,0,18,1,2,0,10,2,3,0,5,1,2,0,10,1,3,0,5,1,2,0,10,1,3,0,5,1,2,0,10,1,3,0,5,1,2,0,10,1,3,0,17,1,3,0,17,1,3,0,7,2,10,1,3,0,7,1,13,0,7,1,13,2,3,1,2,2,1,1,21];
					ls("$n5remember how you have fire powers?$bnow you can hold the jump button mid air to shoot fire out of your butt and fly.$mtry it.$s");
					break;}
					case 8:{map=[1,22,3,8,1,12,0,18,1,2,0,14,2,2,1,4,0,14,1,6,0,5,2,5,0,4,1,6,0,5,1,4,3,1,0,4,1,6,0,5,1,4,3,1,0,4,1,4,0,7,1,4,3,1,0,15,1,4,3,1,0,15,1,4,3,1,0,15,1,4,3,1,0,13,4,1,0,1,1,4,3,1,0,8,2,7,1,4,3,9,1,20];
					ls("$n5bees fly around corn. collect the bees.$bthis is common knowledge.");
					break;}
					case 9:{map=[1,26,3,14,0,4,3,1,1,1,0,14,1,6,0,14,1,6,0,14,1,6,0,3,2,7,0,4,1,5,0,4,1,7,2,1,0,3,1,4,0,6,1,7,0,13,1,6,0,14,3,6,0,42,4,1,0,21,3,20,1,20];
					break;}
					case 10:{map=[1,20,3,7,1,13,0,7,3,4,1,9,0,88,3,1,2,5,1,1,0,2,1,1,2,2,0,8,3,1,1,6,0,2,1,3,0,8,3,1,1,6,0,2,1,3,0,8,3,1,1,6,0,2,1,3,0,7,3,1,1,7,0,2,1,3,0,7,3,1,1,7,0,2,1,3,3,7,1,8,0,2,1,18,0,2,1,3];
					makeSign(352,192,["what's up... um,","so to the right of the screen is bird land.","and down there is spooky land.","$mchoose whichever you want to do$s","- sign maker man"]);
					switchPal(0);
					break;}
					case 11:{map=[1,42,0,9,1,9,0,17,1,3,0,17,1,3,0,17,1,3,0,17,1,5,0,15,1,5,0,15,1,5,0,15,1,5,0,15,1,5,0,4,4,1,0,10,1,63];
					makeSign(480,352,["bird land doesn't exist yet.","sorry."]);
					break;}
					}
				break;}
				case 1:{
					switch(mx){
					case 10:{map=[1,15,0,2,1,18,0,2,1,5,3,1,0,10,1,2,0,2,1,5,3,1,0,10,1,2,0,2,1,5,3,1,0,2,2,6,0,2,1,2,0,2,1,5,3,1,0,2,1,6,0,6,1,5,3,1,0,5,3,1,1,2,0,6,1,5,3,1,0,5,3,1,1,2,2,6,1,5,3,1,0,5,3,1,1,13,3,1,0,5,3,1,1,2,0,9,1,2,3,4,0,2,3,1,1,2,0,9,1,5,3,1,0,2,3,1,1,2,0,2,2,7,1,5,3,1,0,7,1,12,3,1,0,7,1,27];
					makeSign(384,192,["um, yes, hi welcome to sppoky land.","it is always night time here.","watch out 4 ghosts bro."]);
					if(!ev[1]){makeTrigger(576,288,64,64,3);}
					switchPal(1);
					break;}
					case 11:{map=[1,42,3,17,1,3,3,1,0,16,1,3,3,1,0,2,3,2,0,3,3,2,0,2,3,3,0,2,1,3,3,1,0,1,3,1,0,2,3,1,0,1,3,1,0,2,3,1,0,1,3,1,0,2,3,1,0,1,1,3,3,1,0,1,3,1,0,2,3,1,0,1,3,1,0,2,3,1,0,1,3,1,0,2,3,1,0,1,1,3,3,1,0,2,3,2,0,3,3,2,0,2,3,3,0,2,1,3,3,1,0,11,3,1,0,2,3,2,1,1,4,1,0,13,3,1,0,1,3,1,0,2,1,1,4,1,0,16,3,2,1,6,0,13,3,1,1,6,0,11,3,2,0,1,1,6,3,14,1,21];
					ev[1]=true;
					break;}
					}
				break;}
				
				/* TEMPLATE FLOOR
				case 1:{
					switch(mx){
					case 10:{map=[];
					break;}
					}
				break;}
				*/
				}
			}
			
			// Processing map
			function mapProcess(){
				var i = 0;
				for (var y = 0; y < cv.height; y += 32){
					for (var x = 0; x < cv.width; x += 32){
						switch (map[i]){
							case 4:{ // level end (corn & bees)
							// corn
							oCorn = new makeInst(x+8,y+22,3);
							
							// bees
							for (var temp = 0; temp < 4; temp ++){
								new makeInst(x,y,4);
							}
							
							break;}
							case 5:{ // player start (guyman)
							oGM = new makeInst(x,y,1);
							
							break;}
							
						}
						i ++;
					}
				}
			}
			
			// Unstucking guyman when changing maps
			function unstuckGM(){
				var tries = 34;
				var tri = tries;
				
				if (oGM.cw(0,0)){
					while (oGM.cw(0,0)){
						oGM.y --;
						tri --;
						if (tri < 1){
							worked = false;
							oGM.y += tries;
							break;
						}
						
					}
					if (!worked){
						tri = tries;
						while (oGM.cw(0,0)){
							oGM.y ++;
							tri --;
							if (tri < 1){
								break;
							}
						}
					}
				}
			}
			
			// Instances/Particles
			
			// variable used to set particle ids/indexes in ptcl array.
			var currentPtcl = 0;
			var currentInst = 0;
			
			// used to set the max amount of particles there can 
			// be before currentPtcl is reset and particles overwrite old particles
			var maxPtcl = 120;
			
			// Instance & Particle Arrays
			var ptcl = [];
			var inst = [];
			
			// [O] objects
			function makeInst(x,y,o){
				// creating id & pushing into instance array
				this.id = currentInst;
				currentInst ++;
				
				inst.push(this);
				
				// setting x & y
				this.x = x;
				this.y = y;
				
				// setting o (to know what type of object the object is)
				this.o = o;
				
				// object specific code
				switch(o){
				case 0:{//[O template]
				
				this.ud=function(){
				
				
				};
				break;}
				
				case 1:{//[O guyman]
				// movement
				this.hs = 0;
				this.vs = 0;
				this.msp = 4;
				
				this.g = 0.1;
				this.d = 0.1;
				
				
				
				// animation
				this.atmr = 0;
				this.snum = 0;
				this.spr = sGMidle;
				this.facing = 0;
				
				// misc
				this.onfloor = false;
				this.jumpState = 0;
				this.jumpHeight = -4;
				this.ftmr = 1;
				this.powers = GMpowers;
				this.dead = false;
				
				// changing maps
				this.save=function(){
					savex=this.x;
					savey=this.y;
					savehs=this.hs;
					savevs=this.vs;
					savejs=this.jumpState;
					savef=this.facing;
				}
				
				this.mc=function(mx,my){
					this.save();
					lm(mx,my);
				}
				
				// guyman wall collision
				this.cw=function(xahead, yahead){
					return crect(this.x+xahead+8,this.y+yahead+1,18,30,[1,2]);
				}
				
				// dying function
				this.kill=function(){
					if (!this.dead){
						// updating counter
						deaths ++;
						deathsDisplay.innerHTML = deaths;
						
						// reversing speeds
						this.hs *= -1;
						this.vs *= -1;
						
						// skelly
						var oGMskel = new makeInst(this.x,this.y,6);
						oGMskel.hs = this.hs;
						oGMskel.vs = this.vs;
						
						// blood splatter
						for (var i = 0; i < 10; i ++){
							new makeInst(this.x,this.y,2);
						}
						
						// resetting update func
						this.ud=function(){
							// restarting
							if (k3){
								mapRestart = true;
								lm(0,0);
							}
						}
						
						this.dead = true;
						
						ls("his dead. Press ENTER to respawn");
					}
				}
				
				this.ud=function(){
				// checking if on floor
				if (this.cw(0,1)){
					this.onfloor = true;
				} else {
					this.onfloor = false;
				}
				
				// leaving map
				if(this.x<-14){
					this.x = cv.width-16;
					this.mc(-1,0);
				}
				if(this.y<-14){
					this.y = cv.height-16;
					this.mc(0,-1);
				}
				if(this.x>cv.width-14){
					this.x = -12;
					this.mc(1,0);
				}
				if(this.y>cv.height-14){
					this.y = 0;
					this.mc(0,1);
				}
				
				// player input & animation
				var move = kr-kl;
				if (move != 0){
					this.hs += this.d*move;
					
					if (!this.onfloor){
						// air movement sprite
						this.spr = sGMpush;
						
						// side flame particle
						if (this.ftmr==0 && this.jumpState==2){
							var sideFlame = new makePtcl(this.x+12,this.y+8+ri()*2,2);
							sideFlame.s = -this.facing;
						}
						
					} else {
						// waling animation
						this.atmr -= Math.abs(this.hs);
						if (this.atmr <= 1){
							this.atmr = 8;
							
							if (this.snum == 0){
								this.spr = sGMrun2;
								this.snum = 1;
							} else {
								this.spr = sGMrun1;
								this.snum = 0;
							}
						}
					}
					// set facing of guyman
					this.facing = move;
				} else {
					// set sprite when not moving
					if (this.onfloor){
						this.spr = sGMidle;
						// slow down horizontal speed
						if (this.hs != 0){
							var temp = Math.sign(this.hs);
							this.hs -= Math.sign(this.hs)*this.d/2;
							if (temp != Math.sign(this.hs)){
								this.hs = 0;
							}
						}
					} else {
						this.spr = sGMair;
					}
					
					
					
					this.atmr = 0;
				}
				
				// dust skidding particles
				if (move != Math.sign(this.hs) && this.onfloor){
					new makePtcl(8+this.x,26+this.y,3);
				}
				
				// jumping
				if (k1p){
					if (this.onfloor){
						this.vs = this.jumpHeight;
						this.jumpState = 0;
					} else {
						this.jumpState = 1;
					}
				}
				if (k1){
					if (this.jumpState > 0 && this.powers){
						this.vs -= 0.2;
						this.jumpState = 2;
						
						// flame particle
						if (this.ftmr==0){new makePtcl(4+this.x+ri()*2,20+this.y+ri(),1)};
					}
				}
				if (k1r){
					if (this.jumpState == 0){
						this.jumpState = 1;
					}
				}
				
				// keeping speeds from going above max
				if (this.hs > this.msp){this.hs=this.msp;}else if(this.hs < -this.msp){this.hs=-this.msp;}
				//if (this.vs > this.msp){this.vs=this.msp;}else if(this.vs < -this.msp){this.vs=-this.msp;}
				
				// collision
				if (this.cw(this.hs,0)){
					var temp = -Math.sign(this.x-(this.x+this.hs));
					while (!this.cw(temp,0)){
						this.x += temp;
					}
					this.hs = 0;
				}
				this.x += this.hs;
				
				this.vs += this.g;
				if (this.cw(0,this.vs)){
					var temp = -Math.sign(this.y-(this.y+this.vs));
					while (!this.cw(0,temp)){
						this.y += temp;
					}
					this.vs = 0;
				}
				this.y += this.vs;
				
				// drawing self
				
				// scarf
				if (univ){
					dsany(this.x-8,this.y+10,18,10,sScarf);
				} else {
					dsanyv(this.x-8,this.y+10,18,10,sScarf);
				}
				
				// guyman
				if (this.facing==1){
					ds32(this.x,this.y,this.spr);
				} else {
					ds32f(this.x,this.y,this.spr);
				}
				
				
				// flame particle timer
				if (this.ftmr == 0){
					this.ftmr = 2;
				} else {
					this.ftmr --;
				}
				
				// dying
				if (crect(this.x+8,this.y+1,18,30,[3])){
					this.kill();
				}
				
				
				};
				break;}
				case 2:{//[O blood]
				this.vs = (-ri()/3)-1;
				this.g = 0.02;
				this.hs = (ri())-5;
				this.move = true;
				
				this.ud=function(){
				
				if (this.move){
					this.x += this.hs;
					this.vs += this.g;
					this.y += this.vs;
					if (cpt(this.x+16,this.y+16)==1 || cpt(this.x+16,this.y+16)==2){
						this.move = false;
					}
				}
				
				ds32(this.x,this.y,sBlood);
				
				};
				break;}
				case 3:{//[O corn]
				this.ud=function(){
				dsany(this.x,this.y,9,12,sCorn);
				};
				break;}
				case 4:{//[O bee]
				this.hs = 0;
				this.vs = 0;
				
				this.x += ri();
				this.y += ri();
				
				this.tmr = 14;
				
				this.ud=function(){
				if (oCorn != null){
					if (this.x < oCorn.x){this.hs+=0.2;}else{this.hs-=0.2;}
					if (this.y < oCorn.y-16){this.vs+=0.2;}else{this.vs-=0.2;}
				}
				
				this.x += this.hs;
				this.y += this.vs;
				
				this.tmr --;
				if (this.tmr < 1){
					if (ri()==0){
						this.hs += ri()-5;
						this.vs += ri()-5;
					}
					this.tmr = 14;
				}
				
				if (Math.abs(this.hs)>=3){this.hs = 3*Math.sign(this.hs);}
				if (Math.abs(this.vs)>=3){this.vs = 3*Math.sign(this.vs);}
				
				ds8(this.x,this.y,sBee);
				
				// Getting Collected by Guyman
				if (oGM != null){
					if (cprect(this.x,this.y,oGM.x,oGM.y,32,32)){
						inst[this.id] = null;
						
						bees ++;
						beesDisplay.innerHTML = bees;
						
						// making yay particle
						new makePtcl(this.x,this.y,5);
						
						// checking if there are any bees left
						var temp = true;
						
						for (var i = 0; i < inst.length; i ++){
							if (inst[i] != null){
								if (inst[i].o == 4){
									temp = false;
								}
							}
						}
						
						if (temp){
							//new makeInst(0,0,5);
						}
					}
				}
				};
				break;}
				case 5:{// [O wizard magician man]
				this.ftmr = 0;
				
				this.ud=function(){
					if (oGM != null){
						this.y = oGM.y;
						
						if (oGM.x >= this.x){
							inst[this.id]=null;
							dialogueStart([
							"$n0yo. what up. I'm wizard magain man. Who you?",
							"$n1I'm guyman.",
							"$n2cool.",
							"$n1why did you stop me.",
							"$n2because i wanted to give you something.",
							"$n1oh.",
							"$n2here.",
							"you now have flame powers bro.",
							"$n1mkay thanks."
							],[1,0,0,0,0,0,0,0,0,2]);
						}
					}
					
					this.ftmr --;
					if (this.ftmr < 1){
						this.ftmr = 6;
						
						if (cpt(this.x,this.y+34) == false){
							new makePtcl(this.x+ri()*2,this.y+20,1);
						}
					}
					
					ds32w(this.x,this.y,1,sWizard);
				}
				break;}
				case 6:{// [o guyman skeleton]
				this.hs = 0;
				this.vs = 0;
				
				this.g = 0.1;
				
				this.ud=function(){
				// movement
				if (cpt(this.x+16+this.hs,this.y+16)){
					this.hs *= -0.9;
				}
				this.x += this.hs;
				
				this.vs += this.g;
				if (cpt(this.x+16,this.y+16+this.vs)){
					this.vs *= -0.9;
				}
				this.y += this.vs;
				
				
				// drawing
				ds32v(this.x,this.y,sGMded);
				};
				break;}
				case 7:{// [o guyman cutscene]
				this.spr = sGMidle;
				this.scarf = true;
				this.facing = 0;
				
				this.vs = 0;
				this.g = 0.1;
				
				this.ud=function(){
					// collision
					this.vs += this.g;
					if (cpt(this.x+8,this.y+32+this.vs) || cpt(this.x+26,this.y+32+this.vs)){
						var temp = -Math.sign(this.y-(this.y+this.vs));
						while (!cpt(this.x+8,this.y+32+temp) && !cpt(this.x+26,this.y+32+temp)){
							this.y += temp;
						}
						this.vs = 0;
					}
					this.y += this.vs;
					
					// drawing self
					if (this.scarf){if(univ){dsany(this.x-8,this.y+10,18,10,sScarf);} else {dsanyv(this.x-8,this.y+10,18,10,sScarf);}}
					if (this.facing==1){ds32(this.x,this.y,this.spr);} else {ds32f(this.x,this.y,this.spr);}
				};
				break;}
				case 8:{// [o sign]
				this.text = [""];
				
				this.ud=function(){
					if (k2p && crrect(this.x,this.y,16,16,oGM.x,oGM.y,32,32) ){
						dialogueStart(this.text,[0]);
					}
					dsany(this.x,this.y,16,16,sSign);
				};
				break;}
				case 9:{// [o trigger]
				this.e = 0;
				this.w = 32;
				this.h = 32;
				
				this.ud=function(){
					if (oGM != null){
						if (crrect(this.x,this.y,this.w,this.h,oGM.x,oGM.y,32,32)){
							doEvent(this.e);
							inst[this.id]=null;
						}
					}
				}
				break;}
				case 10:{// [o spookyland face]
				this.hs = -1;
				
				this.ud=function(){
					this.x += this.hs;
					if (oGM != null){
						if (crrect(this.x,this.y,32,32,oGM.x,oGM.y,32,32)){
							oGM.kill();
						}
					}
					ds32(this.x,this.y,sFace);
				}
				break;}
				
				// [O indexEnd]
				}
			}
			
			// [P] particles
			function makePtcl(x,y,p){
				if (currentPtcl == maxPtcl){
					currentPtcl = 0;
				}
				this.id = currentPtcl;
				ptcl[this.id]=this;
				
				currentPtcl ++;
				
				this.x = x;
				this.y = y;
				
				// duration (before going bye bye)
				this.d = 24;
				
				switch(p){
				case 0:{// [P template]
				this.ud=function(){
					// disappearing
					this.d--;
					if (this.d<1){
						ptcl[this.id]=null;
					}
				};
				break;}
				
				case 1:{// [P flame downwards]
				this.ud=function(){
					// disappearing
					this.y += this.d/4;
					ds8(this.x,this.y,sFlame);
					
					this.d --;
					if (this.d<1){
						ptcl[this.id]=null;
					}
				};
				break;}
				case 2:{// [P flame sideways]
				this.s = 1;
				
				this.ud=function(){
					// disappearing
					this.x += this.s*this.d/4;
					ds8(this.x,this.y,sFlame);
					
					this.d --;
					if (this.d<1){
						ptcl[this.id]=null;
					}
				};
				break;}
				case 3:{// [P dust]
				this.d = 10;
				this.x += ri();
				this.y += ri();
				
				this.ud=function(){
					// disappearing
					this.y -= this.d/4;
					this.d--;
					if (this.d<1){
						ptcl[this.id]=null;
					}
					dsany(this.x,this.y,5,5,sDust);
				};
				break;}
				case 5:{// [P yay]
				this.d = 40;
				this.ud=function(){
					// disappearing
					this.d--;
					this.y--;
					if (this.d<1){
						ptcl[this.id]=null;
					}
					dsany(this.x,this.y,16,6,sYay);
				};
				break;}
				case 6:{// [P star}
				this.vs = (-ri()/4);
				this.g = 0.02;
				this.hs = (ri()/2)-2;
				
				this.d = 80+ri()*2;
				
				this.ud=function(){
				this.x += this.hs;
				this.vs += this.g;
				this.y += this.vs;
				this.d--;
				if (this.d<1){ptcl[this.id]=null;}
				ds8(this.x,this.y,sStar);
				};
				break;}
				
				// [P indexEnd]
				}
			}
			
			// [GD] GETTING DATA
			
			// sprites (uncompress when needed) (re-compress when not)
			sGMair=uc(sGMair);
			sGMpush=uc(sGMpush);
			sGMded=uc(sGMded);
			sGMidle=uc(sGMidle);
			sGMrun1=uc(sGMrun1);
			sGMrun2=uc(sGMrun2);
			sBrick=uc(sBrick);
			sGrass=uc(sGrass);
			sDirt=uc(sDirt);
			sSpikes=uc(sSpikes);
			sBlood=uc(sBlood);
			sRyan=uc(sRyan);
			sDemon1=uc(sDemon1);
			sDemon2=uc(sDemon2);
			sBird1=uc(sBird1);
			sBird2=uc(sBird2);
			sFace=uc(sFace);
			sScarf=uc(sScarf);
			sCorn=uc(sCorn);
			sDust=uc(sDust);
			sYay=uc(sYay);
			sCloud=uc(sCloud);
			sWizard=uc(sWizard);
			sSign=uc(sSign);
			
			// objects that need to be referenced at specific times (set to null incase they are not created when the map loads)
			
			// guyman
			var oGM = null;
			// cutscene guyman
			var oGMcut = null;
			// cutscene object
			var oCS = null;
			// cutscene props
			var cp1 = null;
			var cp2 = null;
			var cp3 = null;
			var cp4 = null;
			
			// the corn
			var oCorn = null;
			
			var showObjectIDs = false;
			
			// misc variables
			var GMpowers = false;
			var mapx = 4;
			var mapy = 0;
			
			lm(0,0);
			
			// maps
			
			// list of sprites used for map indexes (0 = no sprite)
			var mapSprite = [0,sDirt,sGrass,sSpikes,0,0,0,0,0,0];
			
			// randomization
			var rlist = [0,6,9,4,0,1,8,5,7,6,2,3,9,0,4,7,5,4,8,5,3,5,8,5,0,9,5,9,4,6,2,1,4,0,5,6,3,4,8,1,0,4,7,8,5,0,5,4,2,3,8,0,1,9,1,8,0,7,6,2,0,3,4,8,1,0,4,5,7];
			var rand = 0;
			
			// getting random integer from 0-9
			function ri(){
				rand ++;
				if (rand > rlist.length){rand=0;}
				return rlist[rand];
			}
			
			// [MI] misc functions
			
			// [CS] Cutscenes
			function cutsceneStart(c){
				if (oCS == null){
					// stopping guyman
					if (oGM != null){
						oGM.ud=function(){};
						
						// creating fake guyman used in cutscene
						oGMcut = new makeInst(oGM.x,oGM.y,7);
						oGMcut.vs = oGM.vs;
						oGMcut.facing = oGM.facing;
					}
					
					// making cutscene
					oCS = new makeCSobj(c);
				}
			}
			function cutsceneEnd(){
				// setting key 1 pressed to false so guyman doesn't immediately jump
				k1p = false;
				
				// recreating guyman
				inst[oGM.id]=null;
				oGM = new makeInst(oGMcut.x,oGMcut.y,1);
				oGM.vs = oGMcut.vs;
				oGM.facing = oGMcut.facing;
				
				unstuckGM();
				
				// deleting these bros
				inst[oCS.id]=null;
				inst[oGMcut.id]=null;
				oCS = null;
				oGMcut = null;
				
				log.innerHTML = "";
			}
			function makeCSobj(c){
				// adding self to instance array so the update function is called each frame
				this.x = 0;
				this.y = 0;
				this.o = 0;
				this.id = currentInst;
				currentInst ++;
				inst.push(this);
				
				// t represents each part of the cutscene
				this.t = -1;
				
				// picking cutscene
				switch (c){
				case 0:{this.ud=function(){// [c template]
				// template cutscene code here
				};break;}
				case 1:{// [c dialogue]
				this.event=[0];
				this.text=[""];
				
				// going forward in dialogue
				this.forward=function(){
					this.t ++;
					// executing event
					if (this.t < this.event.length){
						doEvent(this.event[this.t]);
					}
					// displaying text/ending cutscene
					if (this.t > this.text.length){
						cutsceneEnd();
					} else {
						ls(this.text[this.t]);
					}
				}
				
				// update function
				this.ud=function(){
				if (k1p){
					this.forward();
				}};break;}
				
				// [c indexEnd]
				}
			}
			
			// Setting Log Text
			function ls(text){	
				var t = "";
				// formatting HTML of text
				for (var i = 0; i < text.length; i ++){
					if (text[i]=="$"){
						i ++;
						switch (text[i]){
							case "b":{//line break
							t+="<br>";
							break;}
							case "n":{//name of character in dialogue
							t+=cname[parseInt(text[i+1])]+" says:<br><br>";
							i ++;
							break;}
							case "m":{//marquee
							t+="<marquee>";
							break;}
							case "d":{//stop marquee
							t+="</marquee>";
							break;}
						}
					} else {
						t += text[i];
					}
				}
				log.innerHTML = t;
			}
			
			// Creating a dialogue cutscene
			function dialogueStart(dt,de){
				cutsceneStart(1);
				oCS.text = dt;
				oCS.event = de;
				oCS.forward();
			}
			
			// [EV] Events (mainly for cutscene use)
			function doEvent(e){
				switch (e){
					case 1:{// starting wizard cutscene
					pStarBurst(oGM.x,oGM.y,10);
					
					cp1 = new makeInst(oGM.x+40,oGM.y,7);
					cp1.spr=sWizard;
					cp1.scarf=false;
					
					break;}
					case 2:{// giving guyman powers & making wiz go bte bte
					oGM.powers=true;
					GMpowers=true;
					pStarBurst(oGMcut.x,oGMcut.y,20);
					
					cp1.t=0;
					cp1.tm=30;
					cp1.w=0;
					cp1.hs=-1;
					cp1.vs=-3;
					cp1.g=0.01;
					cp1.ud=function(){
						this.t--;
						if(this.t<1){
							this.t=this.tm;
							this.w++;
							if(this.w>20){
								inst[this.id]=null
								cp1=null;
							}
						}
						
						this.vs += this.g;
						this.y += this.vs;
						this.x += this.hs;
						
						ds32w(this.x,this.y,this.w,sWizard);
					}
					
					ev[0]=true;
					
					break;}
					case 3:{// spooky land face jumpscare
					new makeInst(620,310,10);
					break;}
				}
			}
			
			// Star Particle Burst Effect
			function pStarBurst(x,y,n){
				for (var i = 0; i < n; i ++){
					new makePtcl(x,y,6);
				}
			}
			
			// Making Signs
			function makeSign(x,y,textList){
				var temp = new makeInst(x+8,y+16,8);
				temp.text = textList;
			}
			
			// Making Triggers
			function makeTrigger(x,y,w,h,e){
				var temp = new makeInst(x,y,9);
				temp.w=w;
				temp.h=h;
				temp.e=e;
			}
			
			// [C] collision
			
			// Check point for map index
			function cpt(cx,cy){
				var p = Math.floor(cx/32)+Math.floor(cy/32)*20;
				if (map[p] != 0){
					if (cx>0&&cx<cv.width&&cy>0&&cy<cv.height){
						return map[p];
					}
				}
				return false;
			}
			
			// Check rectangle for map index
			function crect(cx,cy,w,h,clist){
			// The "clist" argument is an array containing the map values that will return true
			// example: map index 1 = dirt, so if my clist has 1 in it, the function will check for that and return true if it is found

			// This code looks like shit but it works so yeah
			// I basically just check every corner of the rectangle and see if the result is in the clist array
			var wall=cpt(cx,cy);
			for (var i=0; i<clist.length; i++){
			if (wall==clist[i]){return true;}
			} var wall=cpt(cx+w,cy);
			for (var i=0; i<clist.length; i++){
			if (wall==clist[i]){return true;}
			} var wall=cpt(cx,cy+h);
			for (var i=0; i<clist.length; i++){
			if (wall==clist[i]){return true;}
			} var wall=cpt(cx+w,cy+h);
			for (var i=0; i<clist.length; i++){
			if (wall==clist[i]){return true;}
			} return false;

			}
			
			// Check for point in rectangle
			function cprect(px,py,rx,ry,rw,rh){
				if (px <= rx){return false;}
				if (px >= rx+rw){return false;}
				if (py <= ry){return false;}
				if (py >= ry+rh){return false;}
				return true;
			}
			
			// Check for rectangle in rectangle
			function crrect(cx,cy,cw,ch,rx,ry,rw,rh){
				if (cx > rx && cx < rx+rw && cy > ry && cy < ry+rh){
					return true;
				}
				if (cx+cw > rx && cx+cw < rx+rw && cy > ry && cy < ry+rh){
					return true;
				}
				if (cx > rx && cx < rx+rw && cy+ch > ry && cy+ch < ry+rh){
					return true;
				}
				if (cx+cw > rx && cx+cw < rx+rw && cy+ch > ry && cy+ch < ry+rh){
					return true;
				}
				return false;
			}
			
			
			// [DR] drawing
			function dClear(){
				for (var i = 0; i < c.data.length; i += 4){
					c.data[i]=pal[27];
					c.data[i+1]=pal[28];
					c.data[i+2]=pal[29];
				}
			}
			
			// 32x sprite uncompressed
			var yi32 = (cv.width-32)*4;
			function ds32(sx,sy,spr){
			var p = (Math.round(sx)+Math.round(sy)*cv.width)*4;
			var i = 0;

			for (var y = 0; y < 32; y ++){
			for (var x = 1; x < 33; x ++){
			if (spr[i]!=0&&x+sx<=cv.width&&sx+x>0){
			var color = (spr[i]-1)*3;

			c.data[p] = pal[color];
			c.data[p+1] = pal[color+1];
			c.data[p+2] = pal[color+2];
			c.data[p+3] = 255;
			}
			i ++;
			p += 4;
			}
			p += yi32;
			}
			}
			
			// 32x sprite (not checked if between x 0 and width of canvas) (used for fast map drawing)
			var yi32 = (cv.width-32)*4;
			function ds32m(sx,sy,spr){
			var p = (sx+sy*cv.width)*4;
			var i = 0;
			for (var y = 0; y < 32; y ++){
			for (var x = 0; x < 32; x ++){
			if (spr[i]!=0){
			var color = (spr[i]-1)*3;

			c.data[p] = pal[color];
			c.data[p+1] = pal[color+1];
			c.data[p+2] = pal[color+2];
			c.data[p+3] = 255;
			}
			i ++;
			p += 4;
			}
			p += yi32;
			}
			}
			
			// 32x sprite horizontally flipped
			function ds32f(sx,sy,spr){
			var p = (Math.round(sx)+Math.round(sy)*cv.width)*4;
			var i = 31;
			for (var y = 2; y < 34; y ++){
			for (var x = 1; x < 33; x ++){
			if (spr[i]!=0&&x+sx<=cv.width&&sx+x>0){
			var color = (spr[i]-1)*3;
			c.data[p] = pal[color];
			c.data[p+1] = pal[color+1];
			c.data[p+2] = pal[color+2];
			c.data[p+3] = 255;
			}
			i --;
			p += 4;
			}
			i = (y*32)-1;
			p += yi32;
			}
			}
			
			// 32x sprite vertically flipped
			function ds32v(sx,sy,spr){
			var p = (Math.round(sx)+Math.round(sy+32)*cv.width)*4 + (32*4);
			var i = 0;
			for (var y = 1; y < 33; y ++){
			for (var x = 1; x < 33; x ++){
			if (spr[i]!=0&&x+sx<=cv.width&&sx+x>0){
			var color = (spr[i]-1)*3;
			c.data[p] = pal[color];
			c.data[p+1] = pal[color+1];
			c.data[p+2] = pal[color+2];
			c.data[p+3] = 255;
			}
			i ++;
			p -= 4;
			}
			i = (y*32);
			p -= yi32;
			}
			}
			
			// 32x sprite waving horizontally
			function ds32w(sx,sy,wave,spr){
			var p = (Math.round(sx)+Math.round(sy)*cv.width)*4;
			var i = 0;

			for (var y = 0; y < 32; y ++){
			for (var x = 1; x < 33; x ++){
			if (spr[i]!=0&&x+sx<=cv.width&&sx+x>0){
			var color = (spr[i]-1)*3;
			
			var pd = p + Math.round( Math.sin(y+frame/8)*wave)*4;
			
			c.data[pd] = pal[color];
			c.data[pd+1] = pal[color+1];
			c.data[pd+2] = pal[color+2];
			c.data[pd+3] = 255;
			}
			i ++;
			p += 4;
			}
			p += yi32;
			}
			}
			
			// 8x sprite
			var yi8 = (cv.width-8)*4;
			function ds8(sx,sy,spr){
			var p = (Math.round(sx)+Math.round(sy)*cv.width)*4;
			var i = 0;

			for (var y = 0; y < 8; y ++){
			for (var x = 0; x < 8; x ++){
			if (spr[i] != 0){
			var color = (spr[i]-1)*3;

			c.data[p] = pal[color];
			c.data[p+1] = pal[color+1];
			c.data[p+2] = pal[color+2];
			c.data[p+3] = 255;
			}
			i ++;
			p += 4;
			}
			p += yi8;
			}
			}
			
			// any dimensions sprite
			function dsany(sx,sy,sw,sh,spr){
			var p = (Math.round(sx)+Math.round(sy)*cv.width)*4;
			var i = 0;

			for (var y = 0; y < sh; y ++){
			for (var x = 1; x < sw+1; x ++){
			if (spr[i]!=0&&x+sx<=cv.width&&sx+x>0){
			var color = (spr[i]-1)*3;

			c.data[p] = pal[color];
			c.data[p+1] = pal[color+1];
			c.data[p+2] = pal[color+2];
			c.data[p+3] = 255;
			}
			i ++;
			p += 4;
			}
			p += (cv.width-sw)*4;
			}
			}
			
			// any dimensions sprite vertically flipped
			function dsanyv(sx,sy,sw,sh,spr){
			var p = (Math.round(sx)+Math.round(sy+sh)*cv.width)*4 + (sw*4);
			var i = sw-1;
			for (var y = 2; y < sh+2; y ++){
			for (var x = 1; x < sw+1; x ++){
			if (spr[i]!=0&&x+sx<=cv.width&&sx+x>0){
			var color = (spr[i]-1)*3;
			c.data[p] = pal[color];
			c.data[p+1] = pal[color+1];
			c.data[p+2] = pal[color+2];
			c.data[p+3] = 255;
			}
			i --;
			p -= 4;
			}
			i = (y*sw)-1;
			p -= (cv.width-sw)*4;
			}
			}
			
			// drawing clouds
			var cloud = [];
			
			function makeCloud(y,s){
				this.x = (cv.width/10)*ri();
				this.y = y;
				this.s = s;
				this.ud=function(){
					this.x += this.s;
					if (this.x > cv.width){this.x=0;}
					dsany(this.x,this.y,16,16,sCloud);
				}
			}
			
			for (var i = 0; i < 300; i += 40){
				cloud.push(new makeCloud(i,(ri()/2)+1));
			}
			
			// drawing map
			function dMap(){
				var i = 0;
				for (var y = 0; y < cv.height; y += 32){
					for (var x = 0; x < cv.width; x += 32){
						if (map[i]!=0 && mapSprite[map[i]]!=0){
							ds32m(x,y,mapSprite[map[i]]);
						}
						i ++;
					}
				}
			}
			
			// [U] updating game
			
			cx.fillStyle = "#080;";
			cx.font = "16px courier";
			
			// Framerate variables
			var frame = 0;
			var frameLast = new Date();

			function updateFramerate(){
			var frameThis = new Date();
			var fps = Math.round(1000/(frameThis-frameLast));
			frameLast = frameThis;
			cx.fillText("EFF PEE ESS: "+fps, 10, 20);
			frame ++;
			}
			
			// Other Updating Variables
			requestAnimationFrame(gmUpdate);
			var perFrame = 0;
			
			// Update Game Frame
			function gmUpdate(){
				requestAnimationFrame(gmUpdate);
				
				// debug
				perFrame = 0;
				
				// clearing screen
				dClear();
				
				// drawing clouds
				for (var i = 0; i < cloud.length; i ++){
					cloud[i].ud();
				}
				
				// drawing map
				dMap();
				
				
				// drawing fake guyman
				ds32m(frame,Math.floor(20+Math.sin(frame/8)*2),sGMded);
				
				
				// updating instances
				for (var i = 0; i < inst.length; i ++){
					if (inst[i] != null){
						inst[i].ud();
					}
				}
				
				// updating particles
				for (var i = 0; i < ptcl.length; i ++){
					if (ptcl[i] != null){
						ptcl[i].ud();
					}
				}
				
				// Putting Sprite Data on Canvas
				cx.putImageData(c,0,0);
				
				// Writing Text
				//updateFramerate();
				frame ++;
				
				if (showObjectIDs){
					for (var i = 0; i < inst.length; i ++){
						if (inst[i] != null){
							cx.fillText("id: "+inst[i].id,inst[i].x,inst[i].y);
						}
					}
				}
				
				// Resetting onpress & onrelease keys
				k1p=false;k1r=false;
				k2p=false;k2r=false;
				k3p=false;k3r=false;
				
				// Universal Tick
				uniTick --;
				if (uniTick < 1){
					uniTick = uniReset;
					if (univ){
						univ = false;
					} else {
						univ = true;
					}
				}
				
				
			}
		</script>
		
		
	</body>
</html>